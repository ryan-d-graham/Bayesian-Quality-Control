### Bayesian Quality Control with Jeffreys Prior and Quadratic Costs

#### Overview
Bayesian Quality Control is a method to determine the maximum number of defective items (\( m \)) in a sample from a lot that can be accepted based on cost considerations. This approach uses a Jeffreys prior, likelihood calculations, and posterior distributions to make informed decisions.

#### Probabilistic Components of the Model

1. **Jeffreys Prior**:
   - The Jeffreys prior represents initial beliefs about the number of defectives \( M \) in the lot.
   \[
   P(M) \propto M^{-0.5} \cdot (N - M)^{-0.5}
   \]
   - Normalized to ensure it sums to 1:
   \[
   P(M) = \frac{M^{-0.5} \cdot (N - M)^{-0.5}}{\sum_{M'=0}^{N} (M')^{-0.5} \cdot (N - M')^{-0.5}}
   \]

2. **Likelihood**:
   - The likelihood of observing \( m \) defectives in a sample of size \( n \) from a lot of size \( N \) with \( M \) defectives:
   \[
   P(m | M) = \frac{\binom{M}{m} \binom{N-M}{n-m}}{\binom{N}{n}}
   \]

3. **Posterior Distribution**:
   - The posterior distribution is calculated using Bayes' theorem, updating beliefs about \( M \) given the observed \( m \):
   \[
   P(M | m) = \frac{P(m | M) \cdot P(M)}{\sum_{M'=0}^{N} P(m | M') \cdot P(M')}
   \]
   - Substituting the expressions for \( P(M) \) and \( P(m | M) \), the posterior can be expressed as:
   \[
   P(M | m) = \frac{\binom{M}{m} \binom{N-M}{n-m} \cdot M^{-0.5} \cdot (N-M)^{-0.5}}{\sum_{M'=0}^{N} \binom{M'}{m} \binom{N-M'}{n-m} \cdot (M')^{-0.5} \cdot (N-M')^{-0.5}}
   \]

#### Cost Functions

1. **Expected Accept Cost**:
   - The cost of accepting the lot, considering the cost per defective item, a quadratic penalty, and revenue from non-defective items:
   \[
   \mathbb{E}[C_{\text{accept}} | m] = \sum_{M=0}^{N} (c \cdot M + P \cdot M^2 - R \cdot (N - M)) \cdot P(M | m)
   \]

2. **Expected Reject Cost**:
   - The cost of rejecting the entire lot:
   \[
   \mathbb{E}[C_{\text{reject}}] = N \cdot c + I + D
   \]

#### Decision Rule
- Compare the expected accept and reject costs:
  - **Accept the Lot** if the accept cost is less than the reject cost.
  - **Reject the Lot** if the accept cost is greater than or equal to the reject cost.

### Example Manufacturing Scenario

#### Parameters:
- **Lot Size (\( N \))**: 1000 (Total number of widgets in the lot)
- **Sample Size (\( n \))**: 20 (Number of widgets inspected)
- **Cost per Defective Item (\( c \))**: \$10 (Cost associated with each defective widget)
- **Penalty Cost Coefficient (\( P \))**: \$1 (Additional cost due to lost opportunities or customer dissatisfaction, quadratic penalty)
- **Revenue per Non-Defective Item (\( R \))**: \$20 (Revenue generated by each non-defective widget)
- **Inspection Cost (\( I \))**: \$100 (Cost of inspecting the lot)
- **Delay or Disruption Cost (\( D \))**: \$200 (Cost associated with rejecting the lot due to delays or disruptions)

#### Running the Example

### Command:
```sh
python script.py --lot=1000 --sample=20 --item=10 --penalty=1 --revenue=20 --inspect=100 --delay=200 --plot_prior=true --plot_post=true
